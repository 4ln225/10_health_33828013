<%- include('partials/header') %>

<h2>My Workouts</h2>

<h3>Workouts by Type</h3>

<div style="max-width:400px;margin:auto;">
  <canvas id="workoutChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const labels = <%- JSON.stringify(labels) %>;
  const values = <%- JSON.stringify(values) %>;

  if (labels.length > 0) {
    new Chart(document.getElementById('workoutChart'), {
      type: 'pie',
      data: {
        labels,
        datasets: [{
          data: values,
          backgroundColor: ['#f87171', '#60a5fa', '#facc15']
        }]
      }
    });
  }
</script>

<hr>

<h3>Search Workouts</h3>

<form action="/workouts/search" method="POST" class="form">

  <label>Keyword (notes)</label>
  <input type="text" name="keyword" placeholder="Search notes...">

  <label>Workout Type</label>
  <select name="workout_type">
    <option value="any">Any</option>
    <option>Run</option>
    <option>Gym</option>
    <option>Yoga</option>
    <option>Cycling</option>
    <option>Swimming</option>
  </select>



  <button type="submit" class="btn">Search</button>
</form>


<hr>

<a href="/workouts/add" class="btn">Add New Workout</a>

<table class="workout-table">
  <tr>
    <th>Date</th>
    <th>Type</th>
    <th>Duration</th>
    <th>Intensity</th>
    <th>Notes</th>
    <th>Actions</th>
  </tr>

  <% workouts.forEach(w => { %>
    <tr>
      <td><%= w.workout_date.toISOString().split('T')[0] %></td>
      <td><%= w.workout_type %></td>
      <td><%= w.duration_minutes %> mins</td>
      <td><%= w.intensity %></td>
      <td><%= w.notes || 'â€”' %></td>
      <td>
        <a href="/workouts/edit/<%= w.id %>">Edit</a>
        <form
          action="/workouts/delete/<%= w.id %>"
          method="POST"
          style="display:inline;"
        >
          <button type="submit">Delete</button>
        </form>
      </td>
    </tr>
  <% }) %>
</table>

<%- include('partials/footer') %>



